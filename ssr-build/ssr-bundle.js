module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/preact-quick-draw/",n(n.s="qVkA")}({HteQ:function(e,t){e.exports=require("preact")},K2hm:function(e,t,n){"use strict";function r(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e},set:function(){e=!0}});window.addEventListener("testPassive",(function(){return null}),t),window.removeEventListener("testPassive",(function(){return null}),t)}catch(e){}return e}n.d(t,"a",(function(){return r}));n("QRet")},QRet:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return _}));var r,o,i,a=n("HteQ"),u=0,c=[],s=a.options.__b,d=a.options.__r,l=a.options.diffed,f=a.options.__c,h=a.options.unmount;function p(e,t){a.options.__h&&a.options.__h(o,e,u||t),u=0;var n=o.__H||(o.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function v(e){return u=1,function(e,t,n){var i=p(r++,2);return i.t=e,i.__c||(i.__=[n?n(t):O(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=o),i.__}(O,e)}function _(e,t){var n=p(r++,3);!a.options.__s&&L(n.__H,t)&&(n.__=e,n.__H=t,o.__H.__h.push(n))}function y(){var e;for(c.sort((function(e,t){return e.__v.__b-t.__v.__b}));e=c.pop();)if(e.__P)try{e.__H.__h.forEach(b),e.__H.__h.forEach(g),e.__H.__h=[]}catch(t){e.__H.__h=[],a.options.__e(t,e.__v)}}a.options.__b=function(e){o=null,s&&s(e)},a.options.__r=function(e){d&&d(e),r=0;var t=(o=e.__c).__H;t&&(t.__h.forEach(b),t.__h.forEach(g),t.__h=[])},a.options.diffed=function(e){l&&l(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==c.push(t)&&i===a.options.requestAnimationFrame||((i=a.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),m&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);m&&(t=requestAnimationFrame(n))})(y)),o=null},a.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(b),e.__h=e.__h.filter((function(e){return!e.__||g(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],a.options.__e(n,e.__v)}})),f&&f(e,t)},a.options.unmount=function(e){h&&h(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{b(e)}catch(e){t=e}})),t&&a.options.__e(t,n.__v))};var m="function"==typeof requestAnimationFrame;function b(e){var t=o,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),o=t}function g(e){var t=o;e.__c=e.__(),o=t}function L(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function O(e,t){return"function"==typeof t?t(e):t}},jshJ:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e.Ready="ready",e.Play="play"}(r||(r={})),function(e){e.Pen="pen",e.Spoid="spoid",e.Eraser="eraser"}(o||(o={}))},n8tQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="__layer_"},q1hW:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n("HteQ"),o=n("K2hm"),i=n("jshJ"),a=n("n8tQ");n("z3l7");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&s(e,t)}(v,t);var n,u,l,h=d(v);function v(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),p(f(e=h.call(this)),"mainLayer",void 0),p(f(e),"paintingLayer",void 0),p(f(e),"activeLayer",{}),p(f(e),"readyState",i.b.Ready),p(f(e),"renderData",{}),p(f(e),"renderCursor",{}),p(f(e),"setStrokeStyle",(function(t){t.strokeStyle=e.state.color,t.lineCap=e.state.radius,t.lineJoin="round",t.lineWidth=e.state.size})),p(f(e),"mousedown",(function(t){t.cancelable&&t.preventDefault();var n=e.state,r=function(e){e.strokeStyle=n.color,e.lineCap=n.radius,e.lineJoin="round",e.lineWidth=n.size};if((!("button"in t)||!t.button)&&t.currentTarget){if(e.readyState!==i.b.Ready)return;var o,a,u=n.currentLayer,c=t.currentTarget,s=c.getContext("2d"),d=e.activeLayer[u.id].current.getContext("2d");r(s),r(d);var l=c.getBoundingClientRect();"touches"in t?(o=t.touches[0].clientX-l.left,a=t.touches[0].clientY-l.top):(o=t.clientX-l.left,a=t.clientY-l.top),o=Math.round(o*c.width/c.offsetWidth),a=Math.round(a*c.height/c.offsetHeight);var f=n.cursor===i.a.Eraser,h=e.renderData[u.id];void 0===h&&(e.renderData[u.id]=[],h=[]);var p=e.renderCursor[u.id];void 0===p&&(e.renderCursor[u.id]=0,p=0),h.splice(p,h.length-p,{x:o,y:a,color:n.color,size:n.size,radius:n.radius,isRoot:!0,isTransparent:f,layerId:n.currentLayer.id});var v=h.length;e.renderCursor[u.id]=v,e.readyState=i.b.Play,f&&(d.save(),d.globalCompositeOperation="destination-out"),d.beginPath(),d.moveTo(o,a),s.beginPath(),s.moveTo(o,a)}})),p(f(e),"mousemove",(function(t){t.preventDefault();var n=e.state;if(t.currentTarget){if(e.readyState!==i.b.Play)return;var r,o,a=n.currentLayer,u=t.currentTarget,c=u.getContext("2d"),s=e.activeLayer[a.id].current.getContext("2d"),d=u.getBoundingClientRect();"changedTouches"in t?(r=t.changedTouches[0].clientX-d.left,o=t.changedTouches[0].clientY-d.top):(r=t.clientX-d.left,o=t.clientY-d.top),r=Math.round(r*u.width/u.offsetWidth),o=Math.round(o*u.height/u.offsetHeight);var l=n.cursor===i.a.Eraser,f=e.renderData[a.id];f.push({x:r,y:o,color:n.color,size:n.size,radius:n.radius,isRoot:!1,isTransparent:l,layerId:n.currentLayer.id}),e.renderCursor[a.id]=f.length,s.lineTo(r,o),s.stroke(),c.lineTo(r,o),c.stroke()}})),p(f(e),"mouseup",(function(t){t.cancelable&&t.preventDefault();var n=e.state;if(t.currentTarget){if(e.readyState!==i.b.Play)return;var r,o,a=n.currentLayer,u=t.currentTarget,c=u.getContext("2d"),s=e.activeLayer[a.id].current.getContext("2d"),d=e.mainLayer.current.getContext("2d"),l=u.getBoundingClientRect();"targetTouches"in t?(r=t.targetTouches[0].clientX-l.left,o=t.targetTouches[0].clientY-l.top):(r=t.clientX-l.left,o=t.clientY-l.top),r=Math.round(r*u.width/u.offsetWidth),o=Math.round(o*u.height/u.offsetHeight);var f=n.cursor===i.a.Eraser,h=e.renderData[a.id];h.push({x:r,y:o,color:n.color,size:n.size,radius:n.radius,isRoot:!1,isTransparent:f,layerId:n.currentLayer.id}),e.renderCursor[a.id]=h.length,e.readyState=i.b.Ready,s.lineTo(r,o),s.stroke(),f&&s.restore(),c.lineTo(r,o),c.stroke(),d.beginPath(),d.drawImage(u,0,0,e.props.cWidth,e.props.cHeight),c.clearRect(0,0,e.props.cWidth,e.props.cHeight)}})),p(f(e),"mouseleave",(function(t){e.readyState===i.b.Play&&e.paintingLayer.current!==t.currentTarget&&e.mouseup(t)})),p(f(e),"forceReload",(function(){e.forceUpdate((function(){return e.reload()}))})),p(f(e),"reload",(function(){var t=e.mainLayer.current,n=e.state;if(t){var r,o=t.getContext("2d"),i=null;o.clearRect(0,0,t.width,t.height),o.lineJoin="round",o.beginPath(),n.allLayer.forEach((function(t){var r,a=e.activeLayer[t.id].current.getContext("2d");a.clearRect(0,0,e.props.cWidth,e.props.cHeight),a.lineJoin="round",a.beginPath();for(var u=0;u<e.renderCursor[t.id];u++)(i=e.renderData[t.id][u]).isRoot?(0!==u&&(o.stroke(),i.isTransparent&&o.restore(),o.beginPath(),a.stroke(),i.isTransparent&&a.restore(),a.beginPath()),i.isTransparent&&(o.save(),o.globalCompositeOperation="destination-out",a.save(),a.globalCompositeOperation="destination-out"),o.strokeStyle=i.color,o.lineWidth=i.size,o.lineCap=n.radius,a.strokeStyle=i.color,a.lineWidth=i.size,a.lineCap=n.radius,o.moveTo(i.x,i.y),a.moveTo(i.x,i.y)):(o.lineTo(i.x,i.y),a.lineTo(i.x,i.y));a.stroke(),(null===(r=i)||void 0===r?void 0:r.isTransparent)&&a.restore()})),o.stroke(),(null===(r=i)||void 0===r?void 0:r.isTransparent)&&o.restore()}})),p(f(e),"undo",(function(){for(var t=e.state.currentLayer,n=e.renderCursor[t.id]-1;n>=0&&!e.renderData[t.id][n].isRoot;n--);e.renderCursor[t.id]=Math.max(n,0),e.forceReload()})),p(f(e),"redo",(function(){for(var t=e.state.currentLayer,n=e.renderData[t.id].length,r=e.renderCursor[t.id]+1;r<n&&!e.renderData[t.id][r].isRoot;r++);e.renderCursor[t.id]=Math.min(r,n),e.forceReload()})),p(f(e),"clear",(function(){var t={id:"".concat(a.a).concat(Date.now()),name:"Layer 1"};e.renderData=p({},t.id,[]),e.renderCursor=p({},t.id,0),e.forceReload()})),p(f(e),"SpoidColor",(function(t){if(t.preventDefault(),e.state.cursor===i.a.Spoid&&t.currentTarget){if(e.readyState!==i.b.Ready)return;var n,r,o=t.currentTarget,a=o.getContext("2d"),u=o.getBoundingClientRect();"touches"in t?(n=t.touches[0].clientX-u.left,r=t.touches[0].clientY-u.top):(n=t.clientX-u.left,r=t.clientY-u.top),n=Math.round(n*o.width/o.offsetWidth),r=Math.round(r*o.height/o.offsetHeight);var c=a.getImageData(n,r,1,1).data;if(0===c[4])return;var s="00".concat(c[0].toString(16)).slice(-2),d="00".concat(c[1].toString(16)).slice(-2),l="00".concat(c[2].toString(16)).slice(-2);e.setState({color:"#".concat(s).concat(d).concat(l)})}})),p(f(e),"createLayer",(function(){var t="".concat(a.a).concat(Date.now());e.setState((function(e){var n=e.allLayer;return n.push({id:t,name:"Layer ".concat(n.length+1)}),{allLayer:n}}),(function(){e.renderData[t]=[],e.renderCursor[t]=0,e.activeLayer[t]=Object(r.createRef)()}))})),p(f(e),"deleteLayer",(function(t){e.setState((function(e){var n=e.allLayer,r=n.findIndex((function(e){return e.id===t}));return r>-1&&n.splice(r,1),{allLayer:n}}),(function(){e.renderData[t]&&delete e.renderData[t],e.renderCursor[t]&&delete e.renderCursor[t],e.activeLayer[t]&&delete e.activeLayer[t],e.forceReload()}))})),e.mainLayer=Object(r.createRef)(),e.paintingLayer=Object(r.createRef)();var t={id:"".concat(a.a).concat(Date.now()),name:"Layer 1"};return e.renderData[t.id]=[],e.renderCursor[t.id]=0,e.activeLayer[t.id]=Object(r.createRef)(),e.state={color:"#0d6efd",size:10,cursor:i.a.Pen,radius:"round",currentLayer:t,allLayer:[t]},e}return n=v,(u=[{key:"componentDidMount",value:function(){var e=this.paintingLayer.current;if(e){var t=!!Object(o.a)()&&{passive:!1,capture:!1};e.addEventListener("mousedown",this.mousedown),e.addEventListener("mousemove",this.mousemove,t),e.addEventListener("mouseup",this.mouseup),document.addEventListener("mouseup",this.mouseleave),e.addEventListener("touchstart",this.mousedown),e.addEventListener("touchmove",this.mousemove,t),e.addEventListener("touchend",this.mouseup)}}},{key:"componentWillUnmount",value:function(){var e=this.paintingLayer.current;e&&(e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("mousemove",this.mousemove),e.removeEventListener("mouseup",this.mouseup),document.removeEventListener("mouseup",this.mouseleave),e.removeEventListener("touchstart",this.mousedown),e.removeEventListener("touchmove",this.mousemove),e.removeEventListener("touchend",this.mouseup))}},{key:"render",value:function(t,n){var o=this;return Object(r.h)(e,null,Object(r.h)("div",null,Object(r.h)("div",{id:"painting_canvas",onTouchMove:function(e){e.preventDefault()}},Object(r.h)("canvas",{id:"main_layer",width:t.cWidth,height:t.cHeight,ref:this.mainLayer,style:{opacity:0}}),n.allLayer.map((function(e){return Object(r.h)("canvas",{class:"active_layer",ref:o.activeLayer[e.id],key:e.id,width:t.cWidth,height:t.cHeight,onClick:o.SpoidColor,onTouchStart:o.SpoidColor})})),Object(r.h)("canvas",{id:"painting_layer",width:t.cWidth,height:t.cHeight,ref:this.paintingLayer,style:{display:n.cursor===i.a.Spoid?"none":"block",opacity:0}}))),Object(r.h)("div",{id:"tool_menu"},Object(r.h)("button",{"data-theme":"purple",onClick:function(){return o.setState({cursor:i.a.Pen})}},"Pen"),Object(r.h)("button",{"data-theme":"purple",onClick:function(){return o.setState({cursor:i.a.Spoid})}},"Spoid"),Object(r.h)("button",{"data-theme":"purple",onClick:function(){return o.setState({cursor:i.a.Eraser})}},"Eraser"),Object(r.h)("div",{class:"colorful"},Object(r.h)("input",{type:"input",maxLength:7,value:n.color,onInput:function(e){var t=e.target;o.setState({color:t.value})}}),Object(r.h)("span",{class:"preview_colorful",style:"background: ".concat(n.color)})),Object(r.h)("input",{type:"number",min:0,max:100,maxLength:3,value:n.size,onInput:function(e){var t=e.target;o.setState({size:parseInt(t.value,10)})}}),Object(r.h)("button",{"data-theme":"green",onClick:function(){return o.setState({radius:"round"})}},"Round"),Object(r.h)("button",{"data-theme":"green",onClick:function(){return o.setState({radius:"square"})}},"Square"),Object(r.h)("button",{onClick:function(){return o.undo()}},"Undo"),Object(r.h)("button",{onClick:function(){return o.redo()}},"Redo"),Object(r.h)("button",{onClick:function(){return o.clear()}},"Clear")),Object(r.h)("div",{id:"layer_menu"},Object(r.h)("button",{onClick:function(){return o.createLayer()}},"Create"),Object(r.h)("button",{"data-theme":"green",onClick:function(){return o.setState((function(e){var t=e.allLayer,n=t.findIndex((function(t){return e.currentLayer.id===t.id}));if(n>0){var r=t.splice(n,1)[0];t.splice(n-1,0,r)}return{allLayer:t}}),(function(){return o.reload()}))}},"UP"),Object(r.h)("button",{"data-theme":"green",onClick:function(){return o.setState((function(e){var t=e.allLayer,n=t.findIndex((function(t){return e.currentLayer.id===t.id}));if(n>-1&&n+1<t.length){var r=t.splice(n,1)[0];t.splice(n+1,0,r)}return{allLayer:t}}),(function(){return o.reload()}))}},"DOWN"),Object(r.h)("ul",null,n.allLayer.map((function(e){return Object(r.h)("li",{key:e.id,class:"layer_item ".concat(e.id===n.currentLayer.id?"selected":""),onClick:function(){return o.setState({currentLayer:e})}},e.name,Object(r.h)("span",{onClick:function(){return o.deleteLayer(e.id)}},"삭제"))})))))}}])&&c(n.prototype,u),l&&c(n,l),Object.defineProperty(n,"prototype",{writable:!1}),v}(r.Component);v.defaultProps={cWidth:1920,cHeight:1080}}).call(this,n("HteQ").Fragment)},qVkA:function(e,t,n){"use strict";n.r(t);var r=n("HteQ"),o=n("QRet"),i=n("q1hW"),a=function(){return Object(o.a)((function(){document.title="Quick Drawing"}),[]),Object(r.h)("div",{id:"app"},Object(r.h)(i.a,{cWidth:1920,cHeight:1080}))};t.default=a},z3l7:function(e,t,n){}});